<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 1200 850">
  <!-- OTA Updates Flow Diagram -->
  <defs>
    <style>
      .title { font: bold 28px sans-serif; fill: #1F2937; }
      .subtitle { font: 16px sans-serif; fill: #6B7280; }
      .box-title { font: bold 16px sans-serif; }
      .box-text { font: 13px sans-serif; fill: #374151; }
      .code-text { font: 12px monospace; fill: #1F2937; }
      .label { font: 12px sans-serif; fill: #6B7280; }
      .highlight { font: bold 14px sans-serif; }
    </style>
    
    <marker id="arrow-blue" markerWidth="10" markerHeight="10" refX="9" refY="3" orient="auto">
      <polygon points="0 0, 10 3, 0 6" fill="#3B82F6" />
    </marker>
    
    <marker id="arrow-green" markerWidth="10" markerHeight="10" refX="9" refY="3" orient="auto">
      <polygon points="0 0, 10 3, 0 6" fill="#10B981" />
    </marker>
    
    <marker id="arrow-orange" markerWidth="10" markerHeight="10" refX="9" refY="3" orient="auto">
      <polygon points="0 0, 10 3, 0 6" fill="#F59E0B" />
    </marker>
  </defs>
  
  <!-- Title -->
  <text x="600" y="40" text-anchor="middle" class="title">OTA Updates Flow</text>
  <text x="600" y="65" text-anchor="middle" class="subtitle">Channels, Branches and Runtime Versions</text>
  
  <!-- Configuration Section -->
  <g id="configuration">
    <rect x="50" y="100" width="1100" height="180" rx="8" fill="#F9FAFB" stroke="#E5E7EB" stroke-width="2"/>
    <text x="70" y="130" class="box-title" fill="#4F46E5">‚öôÔ∏è Configuration Files</text>
    
    <!-- eas.json -->
    <rect x="70" y="150" width="350" height="110" rx="6" fill="#EEF2FF" stroke="#4F46E5" stroke-width="2"/>
    <text x="90" y="175" class="box-title" fill="#4F46E5">eas.json</text>
    <text x="90" y="198" class="code-text">"build": {</text>
    <text x="110" y="218" class="code-text">"production": {</text>
    <text x="130" y="238" class="code-text" fill="#F59E0B">"channel": "production"</text>
    <text x="110" y="258" class="code-text">}</text>
    
    <!-- app.json -->
    <rect x="440" y="150" width="350" height="110" rx="6" fill="#FEF3C7" stroke="#F59E0B" stroke-width="2"/>
    <text x="460" y="175" class="box-title" fill="#F59E0B">app.json</text>
    <text x="460" y="198" class="code-text">"updates": {</text>
    <text x="480" y="218" class="code-text" fill="#10B981">"enabled": true,</text>
    <text x="480" y="238" class="code-text">"checkAutomatically": "ON_LOAD"</text>
    <text x="460" y="258" class="code-text">}</text>
    
    <!-- Runtime Version -->
    <rect x="810" y="150" width="320" height="110" rx="6" fill="#D1FAE5" stroke="#10B981" stroke-width="2"/>
    <text x="830" y="175" class="box-title" fill="#10B981">Runtime Version</text>
    <text x="830" y="198" class="code-text">"runtimeVersion": {</text>
    <text x="850" y="218" class="code-text">"policy": "sdkVersion"</text>
    <text x="830" y="238" class="code-text">}</text>
  </g>
  
  <!-- Build with Channel -->
  <g id="build-section">
    <text x="200" y="340" class="box-title" fill="#3B82F6">1Ô∏è‚É£ Create Build with Channel</text>
    
    <rect x="80" y="360" width="240" height="100" rx="8" fill="#DBEAFE" stroke="#3B82F6" stroke-width="3"/>
    <text x="200" y="385" text-anchor="middle" class="highlight" fill="#3B82F6">Production Build</text>
    <text x="200" y="410" text-anchor="middle" class="code-text">$ eas build --platform all</text>
    <text x="200" y="430" text-anchor="middle" class="code-text">--profile production</text>
    <text x="200" y="450" text-anchor="middle" class="label">Channel: <tspan fill="#F59E0B" font-weight="bold">production</tspan></text>
  </g>
  
  <!-- Channel Connection -->
  <line x1="200" y1="460" x2="200" y2="510" stroke="#3B82F6" stroke-width="3" marker-end="url(#arrow-blue)"/>
  <text x="220" y="490" class="label" fill="#3B82F6">linked to ‚Üí</text>
  
  <!-- Channel Box -->
  <g id="channel">
    <rect x="100" y="510" width="200" height="80" rx="8" fill="#FEF3C7" stroke="#F59E0B" stroke-width="3"/>
    <text x="200" y="535" text-anchor="middle" class="box-title" fill="#F59E0B">Channel</text>
    <text x="200" y="560" text-anchor="middle" class="highlight" fill="#F59E0B">"production"</text>
    <text x="200" y="580" text-anchor="middle" class="label">Connects builds ‚Üí updates</text>
  </g>
  
  <!-- Publish Update -->
  <g id="publish-section">
    <text x="550" y="340" class="box-title" fill="#10B981">2Ô∏è‚É£ Publish OTA Update</text>
    
    <rect x="430" y="360" width="240" height="100" rx="8" fill="#D1FAE5" stroke="#10B981" stroke-width="3"/>
    <text x="550" y="385" text-anchor="middle" class="highlight" fill="#10B981">OTA Update</text>
    <text x="550" y="410" text-anchor="middle" class="code-text">$ eas update</text>
    <text x="550" y="430" text-anchor="middle" class="code-text">--branch production</text>
    <text x="550" y="450" text-anchor="middle" class="label">Branch: <tspan fill="#F59E0B" font-weight="bold">production</tspan></text>
  </g>
  
  <!-- Branch Connection -->
  <line x1="550" y1="460" x2="550" y2="510" stroke="#10B981" stroke-width="3" marker-end="url(#arrow-green)"/>
  <text x="570" y="490" class="label" fill="#10B981">published to ‚Üí</text>
  
  <!-- Branch Box -->
  <g id="branch">
    <rect x="450" y="510" width="200" height="80" rx="8" fill="#D1FAE5" stroke="#10B981" stroke-width="3"/>
    <text x="550" y="535" text-anchor="middle" class="box-title" fill="#10B981">Branch</text>
    <text x="550" y="560" text-anchor="middle" class="highlight" fill="#10B981">"production"</text>
    <text x="550" y="580" text-anchor="middle" class="label">Stream of updates</text>
  </g>
  
  <!-- Preview Build/Update -->
  <g id="preview-section">
    <text x="900" y="340" class="box-title" fill="#F59E0B">Alternative: Preview</text>
    
    <!-- Preview Build -->
    <rect x="780" y="360" width="240" height="100" rx="8" fill="#FEF3C7" stroke="#F59E0B" stroke-width="2"/>
    <text x="900" y="385" text-anchor="middle" class="highlight" fill="#F59E0B">Preview Build</text>
    <text x="900" y="410" text-anchor="middle" class="code-text">--profile preview</text>
    <text x="900" y="430" text-anchor="middle" class="label">Channel: <tspan fill="#F59E0B" font-weight="bold">preview</tspan></text>
    <text x="900" y="450" text-anchor="middle" class="code-text">--branch preview</text>
  </g>
  
  <!-- Preview Channel -->
  <line x1="900" y1="460" x2="900" y2="510" stroke="#F59E0B" stroke-width="2" marker-end="url(#arrow-orange)"/>
  
  <rect x="800" y="510" width="200" height="80" rx="8" fill="#FEF3C7" stroke="#F59E0B" stroke-width="2"/>
  <text x="900" y="535" text-anchor="middle" class="box-title" fill="#F59E0B">Channel: preview</text>
  <text x="900" y="560" text-anchor="middle" class="label">For testing/staging</text>
  <text x="900" y="580" text-anchor="middle" class="label">Isolated from production</text>
  
  <!-- User Devices -->
  <g id="user-devices">
    <text x="600" y="650" text-anchor="middle" class="box-title" fill="#4F46E5">3Ô∏è‚É£ Users Receive Updates</text>
    
    <!-- Production Users -->
    <rect x="150" y="680" width="180" height="100" rx="8" fill="#EEF2FF" stroke="#4F46E5" stroke-width="2"/>
    <text x="240" y="705" text-anchor="middle" class="highlight" fill="#4F46E5">üì± Production Users</text>
    <text x="240" y="730" text-anchor="middle" class="box-text">Build with channel:</text>
    <text x="240" y="750" text-anchor="middle" class="label" fill="#F59E0B" font-weight="bold">"production"</text>
    <text x="240" y="770" text-anchor="middle" class="box-text">‚úì Gets production updates</text>
    
    <!-- Preview Users -->
    <rect x="870" y="680" width="180" height="100" rx="8" fill="#FEF3C7" stroke="#F59E0B" stroke-width="2"/>
    <text x="960" y="705" text-anchor="middle" class="highlight" fill="#F59E0B">üß™ Preview Users</text>
    <text x="960" y="730" text-anchor="middle" class="box-text">Build with channel:</text>
    <text x="960" y="750" text-anchor="middle" class="label" fill="#F59E0B" font-weight="bold">"preview"</text>
    <text x="960" y="770" text-anchor="middle" class="box-text">‚úì Gets preview updates</text>
    
    <!-- No Channel Users -->
    <rect x="510" y="680" width="180" height="100" rx="8" fill="#FEE2E2" stroke="#EF4444" stroke-width="2"/>
    <text x="600" y="705" text-anchor="middle" class="highlight" fill="#EF4444">‚ùå No Channel</text>
    <text x="600" y="730" text-anchor="middle" class="box-text">Build without channel</text>
    <text x="600" y="750" text-anchor="middle" class="label" fill="#EF4444" font-weight="bold">undefined</text>
    <text x="600" y="770" text-anchor="middle" class="box-text">‚úó No updates received</text>
  </g>
  
  <!-- Arrows from channel/branch to users -->
  <line x1="200" y1="590" x2="240" y2="680" stroke="#10B981" stroke-width="2" stroke-dasharray="5,5"/>
  <line x1="550" y1="590" x2="240" y2="680" stroke="#10B981" stroke-width="2" stroke-dasharray="5,5"/>
  
  <line x1="900" y1="590" x2="960" y2="680" stroke="#F59E0B" stroke-width="2" stroke-dasharray="5,5"/>
  
  <!-- Bug #5 Note -->
  <rect x="50" y="800" width="550" height="40" rx="6" fill="#FEE2E2" stroke="#EF4444" stroke-width="2"/>
  <text x="70" y="825" class="highlight" fill="#EF4444">üêõ Bug #5: OTA without channel configured</text>
  <text x="440" y="825" class="box-text">‚Üí Updates won't reach users!</text>
  
  <!-- Best Practice -->
  <rect x="620" y="800" width="560" height="40" rx="6" fill="#D1FAE5" stroke="#10B981" stroke-width="2"/>
  <text x="640" y="825" class="highlight" fill="#10B981">‚úì Best Practice:</text>
  <text x="780" y="825" class="box-text">Always match channel (build) with branch (update)</text>
</svg>
